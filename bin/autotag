#!/usr/bin/env ruby
require File.expand_path(File.join(File.dirname(__FILE__), "..", "lib", "auto_tagger"))

begin
  # The dup is to keep ARGV intact, so that tools like ruby-debug can respawn.
  success, message = AutoTagger::CommandLine.new(ARGV.dup).execute
  puts message
  Kernel.exit(success ? 0 : 1)
rescue SystemExit => e
  Kernel.exit(e.status)
rescue Exception => e
  STDERR.puts("Error occured:")
  STDERR.puts("  #{e.message} (#{e.class})")
  STDERR.puts(e.backtrace.join("\n  "))
  Kernel.exit(1)
end
